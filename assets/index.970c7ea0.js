var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,a=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;import{t as i,e as o,s,r as l,j as c,d,a as u,u as h,C as f,A as p,b as m,G as g,m as y,c as v,f as w,g as x,h as b,T as k,i as O,B as S,P as I,F as C,k as E,l as T,n as M,o as D,R as A,p as $}from"./vendor.4247c2e5.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const N={r:0,g:51,b:187,a:255};function P(e,t,r){const n=t+r*e.width;return{r:e.data[4*n],g:e.data[4*n+1],b:e.data[4*n+2],a:e.data[4*n+3]}}function F(e,t){return Math.abs(e.r-t.r)<1&&Math.abs(e.g-t.g)<1&&Math.abs(e.b-t.b)<1&&Math.abs(e.a-t.a)<1}function j(e,t,r,n){let a=null;if(n.forEach((e=>{t>=e.x0&&t<=e.x1&&r>=e.y0&&r<=e.y1&&(a=e)})),a)return a;const i=function(e,t,r){const n=P(e,t,r);let a=r-1;for(;a>=0&&F(n,P(e,t,a));)a-=1;a+=1;let i=r+1;for(;i<e.height&&F(n,P(e,t,i));)i+=1;i-=1;let o=t-1;for(;o>=0&&F(n,P(e,o,r));)o-=1;o+=1;let s=t+1;for(;s<e.width&&F(n,P(e,s,r));)s+=1;return s-=1,{x0:o,x1:s,y0:a,y1:i}}(e,t,r);n.push(i)}function L(e,t,r,n){let a=r,i=!1;for(;a>0;){a-=1;if(F(t,P(e,a,n))){if(i){a-=1;break}i=!0}else i=!1}let o=n;for(i=!1;o>0;){o-=1;if(F(t,P(e,a,o))){if(i){o+=3;break}i=!0}else i=!1}return function(e,t,r,n){let a=n;for(;a>=0&&!F(t,P(e,r,a));)a-=1;a+=1;let i=r;for(;i>=0&&!F(t,P(e,i,a));)i-=1;i+=1;let o=n;for(;o<e.height&&!F(t,P(e,r,o));)o+=1;o-=1;let s=r;for(;s<e.width&&!F(t,P(e,s,o));)s+=1;return s-=1,{x0:i,x1:s,y0:a,y1:o}}(e,t,a,o)}async function W(e){i("finding events...");const t=function(e,t){const r=[];for(let n=0;n<t.height;n+=1)for(let a=0;a<t.width;a+=1)F(e,P(t,a,n))&&j(t,a,n,r);return r}(N,e).reduce(((e,t)=>{const r=e.find((e=>e.y0===t.y0));return r?(r.x0=Math.min(r.x0,t.x0),r.x1=Math.max(r.x1,t.x1),r.y1=Math.max(r.y1,t.y1)):e.push(t),e}),[]);i(`found ${t.length} events`);const r=t[0].x0-1;let n=t[0].y0;const a=P(e,r,n);for(n+=1;F(a,P(e,r,n));)n+=1;const l=function(e,t,r){const n=P(e,t,r);let a=t-1;for(;F(n,P(e,a,r));)a-=1;const i=P(e,a,r);let o=t+1;for(;F(n,P(e,o,r));)o+=1;return{width:o-a,borderColor:i}}(e,r,n),c=l.width,d=L(e,l.borderColor,r,n),u=new ImageData(d.x1-d.x0,d.y1-d.y0);for(let i=0;i<u.height;i+=1)for(let t=0;t<u.width;t+=1){const r=4*(u.width*i+t),n=4*(d.x0+t+(d.y0+i)*e.width);u.data[r]=e.data[n],u.data[r+1]=e.data[n+1],u.data[r+2]=e.data[n+2],u.data[r+3]=e.data[n+3]}i("Figuring out the dates...");const h=await async function(e){const t=o(e);return(await s.recognize(new File([t],"image.png"),"eng")).data.lines[0].text.replace(/\n$/g,"")}(u);i(`Found first date "${h}"`);const f=new Date(h),p=d.y1-d.y0+1,m=t.map((e=>{const t=Math.floor((e.y0-d.y0)/p);return{startsAtTime:(e.x0-d.x1-3)/c,endsAtTime:(e.x1-d.x1-1)/c,daysOffsetFromFirst:t}})).map((e=>{const t=new Date(f);t.setDate(t.getDate()+e.daysOffsetFromFirst),t.setHours(Math.floor(e.startsAtTime)),t.setMinutes(e.startsAtTime%1*60);const r=new Date(t);return r.setHours(Math.floor(e.endsAtTime)),r.setMinutes(e.endsAtTime%1*60),{workStartTime:t,workEndTime:r}}));i("generating google calendar urls");const g=m.map((e=>{const t="Work",r="Automatically parsed from picture, hopefully dates are correct...",n=e.workStartTime,a=e.workEndTime;return{title:t,description:r,googleCreateEventUrl:function(e,t,r,n,a){return`https://calendar.google.com/calendar/u/0/r/eventedit?text=${r}&dates=${function(e,t){function r(e){return e.toISOString().replace(/-|:|\./g,"")}return`${r(e)}/${r(t)}`}(e,t)}${n?`&details=${n}`:""}${a?`&location=${a}`:""}`}(e.workStartTime,e.workEndTime,t,r),startDate:n,endDate:a}}));return i("Done parsing"),g}const z=l.exports.createContext({inputImage:void 0,isProcessing:!1,parsedEvents:[]}),H=e=>{const{children:t}=e,[r,n]=l.exports.useState(!1),[a,o]=l.exports.useState(),[s,u]=l.exports.useState([]);return l.exports.useEffect((()=>{const e=async e=>{var t,r;n(!0),o(void 0),u([]);const a=Array.from(null!=(r=null==(t=e.clipboardData)?void 0:t.files)?r:[]),s=a.filter((e=>"image/png"===e.type));if(a.length>s.length&&i.warn("Clipboard paste does not contain a .png image"),s.length<=0)return i.error("Clipboard paste does not contain a file"),void n(!1);s.length>1&&i("Pasted multiple files, how did you do that? picking only one...");const l=s[0],c=d(await l.arrayBuffer());o(new ImageData(new Uint8ClampedArray(c.data),c.width,c.height));const h=await W(c);u(h),n(!1)};return document.addEventListener("paste",e),()=>{document.removeEventListener("paste",e)}}),[]),c(z.Provider,{value:{isProcessing:r,inputImage:a,parsedEvents:s},children:t})};const{makeStyles:U,useStyles:B}=u.createMakeStyles({useTheme:function(){return((e,i)=>{for(var o in i||(i={}))r.call(i,o)&&a(e,o,i[o]);if(t)for(var o of t(i))n.call(i,o)&&a(e,o,i[o]);return e})({},h())}}),R=U()(((e,t,r)=>({resultsOverlay:{position:"absolute",top:0,left:0},previewCardWrapper:{display:"flex",alignItems:"center"},previewCard:{width:"10vw"},canvas:{width:"100%",maxWidth:"50vw"},cardTitle:{fontSize:14}}))),G=e=>{const{classes:t}=R(),r=l.exports.useContext(z),n=l.exports.useRef(null);return l.exports.useEffect((()=>{if(!n.current)return;const e=n.current.getContext("2d");e&&r.inputImage&&(n.current.height=r.inputImage.height,n.current.width=r.inputImage.width,e.putImageData(r.inputImage,0,0),n.current.scrollIntoView())}),[r,r.inputImage]),c("div",{className:t.resultsOverlay,children:c(f,{maxWidth:!1,children:c(p,{children:m(g,{container:!0,children:[r.inputImage?c(g,{item:!0,children:m(y.div,{className:t.previewCardWrapper,exit:{scale:0,transition:{ease:"backOut",duration:.4}},initial:{scale:0},animate:{scale:1,transformOrigin:"left top",transition:{ease:"backOut",duration:.4}},children:[c(f,{style:{zIndex:1},children:c(y.div,{whileHover:{scale:5,transition:{ease:"backOut",duration:.4}},animate:{transformOrigin:"left top"},children:c(v,{className:t.previewCard,children:c(w,{children:c("canvas",{className:t.canvas,ref:n})})})})}),c(x,{})]})}):null,c(g,{item:!0,children:c(f,{children:c(g,{container:!0,spacing:3,children:r.parsedEvents.map((e=>c(g,{item:!0,children:c(y.div,{exit:{scale:0,transition:{ease:"backOut",duration:.4}},initial:{scale:0},animate:{scale:1,transformOrigin:"left top",transition:{ease:"backOut",duration:.4}},children:m(v,{children:[m(b,{children:[c(k,{variant:"h5",component:"h2",children:e.title}),c(k,{variant:"body1",component:"p",children:e.description}),m(k,{variant:"body2",component:"p",children:["Start: ",e.startDate.toString()]}),m(k,{variant:"body2",component:"p",children:["End: ",e.endDate.toString()]})]}),c(O,{children:c(S,{size:"small",variant:"contained",color:"primary",href:e.googleCreateEventUrl,children:"Google calendar create this event"})})]})})},e.googleCreateEventUrl)))})})})]})})})})},V=U()((e=>({title:{fontSize:"10em"},wrapper:{height:"100vh",maxHeight:"100%",width:"100vw",maxWidth:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}))),q=()=>{const{classes:e}=V();return c(I,{className:e.wrapper,children:c(k,{variant:"h1",className:e.title,children:"CTRL + V"})})},K=e=>(l.exports.useState(!1),m(C,{children:[c("div",{children:c(q,{})}),c(G,{})]}));const J=()=>{const e=E({palette:{mode:"light"}});return m(C,{children:[c(T,{}),c(M,{theme:e,children:m(H,{children:[c(K,{}),c(D,{})]})})]})};A.render(c($.StrictMode,{children:c(J,{})}),document.getElementById("root"));
