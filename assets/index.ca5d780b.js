import{t as e,e as t,s as r,r as n,j as a,d as i,m as o,C as s,A as c,a as l,G as d,b as u,c as h,f,g as p,h as m,T as g,i as y,B as v,P as w,F as x,k as b,l as k,n as C,o as I,R as E,p as S}from"./vendor.116ec2a7.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const O={r:0,g:51,b:187,a:255};function T(e,t,r){const n=t+r*e.width;return{r:e.data[4*n],g:e.data[4*n+1],b:e.data[4*n+2],a:e.data[4*n+3]}}function M(e,t){return Math.abs(e.r-t.r)<1&&Math.abs(e.g-t.g)<1&&Math.abs(e.b-t.b)<1&&Math.abs(e.a-t.a)<1}function D(e,t,r,n){let a=null;if(n.forEach((e=>{t>=e.x0&&t<=e.x1&&r>=e.y0&&r<=e.y1&&(a=e)})),a)return a;const i=function(e,t,r){const n=T(e,t,r);let a=r-1;for(;a>=0&&M(n,T(e,t,a));)a-=1;a+=1;let i=r+1;for(;i<e.height&&M(n,T(e,t,i));)i+=1;i-=1;let o=t-1;for(;o>=0&&M(n,T(e,o,r));)o-=1;o+=1;let s=t+1;for(;s<e.width&&M(n,T(e,s,r));)s+=1;return s-=1,{x0:o,x1:s,y0:a,y1:i}}(e,t,r);n.push(i)}function A(e,t,r,n){let a=r,i=!1;for(;a>0;){a-=1;if(M(t,T(e,a,n))){if(i){a-=1;break}i=!0}else i=!1}let o=n;for(i=!1;o>0;){o-=1;if(M(t,T(e,a,o))){if(i){o+=3;break}i=!0}else i=!1}return function(e,t,r,n){let a=n;for(;a>=0&&!M(t,T(e,r,a));)a-=1;a+=1;let i=r;for(;i>=0&&!M(t,T(e,i,a));)i-=1;i+=1;let o=n;for(;o<e.height&&!M(t,T(e,r,o));)o+=1;o-=1;let s=r;for(;s<e.width&&!M(t,T(e,s,o));)s+=1;return s-=1,{x0:i,x1:s,y0:a,y1:o}}(e,t,a,o)}async function $(n){e("finding events...");const a=function(e,t){const r=[];for(let n=0;n<t.height;n+=1)for(let a=0;a<t.width;a+=1)M(e,T(t,a,n))&&D(t,a,n,r);return r}(O,n).reduce(((e,t)=>{const r=e.find((e=>e.y0===t.y0));return r?(r.x0=Math.min(r.x0,t.x0),r.x1=Math.max(r.x1,t.x1),r.y1=Math.max(r.y1,t.y1)):e.push(t),e}),[]);e(`found ${a.length} events`);const i=a[0].x0-1;let o=a[0].y0;const s=T(n,i,o);for(o+=1;M(s,T(n,i,o));)o+=1;const c=function(e,t,r){const n=T(e,t,r);let a=t-1;for(;M(n,T(e,a,r));)a-=1;const i=T(e,a,r);let o=t+1;for(;M(n,T(e,o,r));)o+=1;return{width:o-a,borderColor:i}}(n,i,o),l=c.width,d=A(n,c.borderColor,i,o),u=new ImageData(d.x1-d.x0,d.y1-d.y0);for(let e=0;e<u.height;e+=1)for(let t=0;t<u.width;t+=1){const r=4*(u.width*e+t),a=4*(d.x0+t+(d.y0+e)*n.width);u.data[r]=n.data[a],u.data[r+1]=n.data[a+1],u.data[r+2]=n.data[a+2],u.data[r+3]=n.data[a+3]}e("Figuring out the dates...");const h=await async function(e){const n=t(e);return(await r.recognize(new File([n],"image.png"),"eng")).data.lines[0].text.replace(/\n$/g,"")}(u);e(`Found first date "${h}"`);const f=new Date(h),p=d.y1-d.y0+1,m=a.map((e=>{const t=Math.floor((e.y0-d.y0)/p);return{startsAtTime:(e.x0-d.x1-3)/l,endsAtTime:(e.x1-d.x1-1)/l,daysOffsetFromFirst:t}})).map((e=>{const t=new Date(f);t.setDate(t.getDate()+e.daysOffsetFromFirst),t.setHours(Math.floor(e.startsAtTime)),t.setMinutes(e.startsAtTime%1*60);const r=new Date(t);return r.setHours(Math.floor(e.endsAtTime)),r.setMinutes(e.endsAtTime%1*60),{workStartTime:t,workEndTime:r}}));e("generating google calendar urls");const g=m.map((e=>{const t="Work",r="Automatically parsed from picture, hopefully dates are correct...",n=e.workStartTime,a=e.workEndTime;return{title:t,description:r,googleCreateEventUrl:function(e,t,r,n,a){return`https://calendar.google.com/calendar/u/0/r/eventedit?text=${r}&dates=${function(e,t){function r(e){return e.toISOString().replace(/-|:|\./g,"")}return`${r(e)}/${r(t)}`}(e,t)}${n?`&details=${n}`:""}${a?`&location=${a}`:""}`}(e.workStartTime,e.workEndTime,t,r),startDate:n,endDate:a}}));return e(JSON.stringify(g)),g}const N=n.exports.createContext({inputImage:void 0,isProcessing:!1,parsedEvents:[]}),F=t=>{const{children:r}=t,[o,s]=n.exports.useState(!1),[c,l]=n.exports.useState(),[d,u]=n.exports.useState([]);return n.exports.useEffect((()=>{const t=async t=>{var r,n;s(!0),l(void 0),u([]);const a=Array.from(null!=(n=null==(r=t.clipboardData)?void 0:r.files)?n:[]),o=a.filter((e=>"image/png"===e.type));if(a.length>o.length&&e.warn("Clipboard paste does not contain a .png image"),o.length<=0)return e.error("Clipboard paste does not contain a file"),void s(!1);o.length>1&&e("Pasted multiple files, how did you do that? picking only one...");const c=o[0],d=i(await c.arrayBuffer());l(new ImageData(new Uint8ClampedArray(d.data),d.width,d.height));const h=await $(d);u(h),s(!1)};return document.addEventListener("paste",t),()=>{document.removeEventListener("paste",t)}}),[]),a(N.Provider,{value:{isProcessing:o,inputImage:c,parsedEvents:d},children:r})},L=o({resultsOverlay:{position:"absolute",top:0,left:0},previewCardWrapper:{display:"flex",alignItems:"center"},previewCard:{width:"10vw"},canvas:{width:"100%",maxWidth:"50vw"},cardTitle:{fontSize:14}}),P=e=>{const t=L(),r=n.exports.useContext(N),i=n.exports.useRef(null);return n.exports.useEffect((()=>{if(!i.current)return;const e=i.current.getContext("2d");e&&r.inputImage&&(i.current.height=r.inputImage.height,i.current.width=r.inputImage.width,e.putImageData(r.inputImage,0,0),i.current.scrollIntoView())}),[r,r.inputImage]),a("div",{className:t.resultsOverlay,children:a(s,{maxWidth:!1,children:a(c,{children:l(d,{container:!0,children:[r.inputImage?a(d,{item:!0,children:l(u.div,{className:t.previewCardWrapper,exit:{scale:0,transition:{ease:"backOut",duration:.4}},initial:{scale:0},animate:{scale:1,transformOrigin:"left top",transition:{ease:"backOut",duration:.4}},children:[a(s,{style:{zIndex:1},children:a(u.div,{whileHover:{scale:5,transition:{ease:"backOut",duration:.4}},animate:{transformOrigin:"left top"},children:a(h,{className:t.previewCard,children:a(f,{children:a("canvas",{className:t.canvas,ref:i})})})})}),a(p,{})]})}):null,a(d,{item:!0,children:a(s,{children:a(d,{container:!0,spacing:3,children:r.parsedEvents.map((e=>a(d,{item:!0,children:a(u.div,{exit:{scale:0,transition:{ease:"backOut",duration:.4}},initial:{scale:0},animate:{scale:1,transformOrigin:"left top",transition:{ease:"backOut",duration:.4}},children:l(h,{children:[l(m,{children:[a(g,{variant:"h5",component:"h2",children:e.title}),a(g,{variant:"body1",component:"p",children:e.description}),l(g,{variant:"body2",component:"p",children:["Start: ",e.startDate.toString()]}),l(g,{variant:"body2",component:"p",children:["End: ",e.endDate.toString()]})]}),a(y,{children:a(v,{size:"small",variant:"contained",color:"primary",href:e.googleCreateEventUrl,children:"Google calendar create this event"})})]})})},e.googleCreateEventUrl)))})})})]})})})})},W=o((e=>({title:{fontSize:"10em"},wrapper:{height:"100vh",maxHeight:"100%",width:"100vw",maxWidth:"100%",display:"flex",alignItems:"center",justifyContent:"center"}}))),z=()=>{const e=W();return a(w,{className:e.wrapper,children:a(g,{variant:"h1",className:e.title,children:"CTRL + V"})})},H=e=>(n.exports.useState(!1),l(x,{children:[a("div",{children:a(z,{})}),a(P,{})]}));const U=()=>{const e=b({palette:{type:"light"}});return l(x,{children:[a(k,{}),a(C,{theme:e,children:l(F,{children:[a(H,{}),a(I,{})]})})]})};E.render(a(S.StrictMode,{children:a(U,{})}),document.getElementById("root"));
